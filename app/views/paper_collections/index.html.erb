<h1><%= @customer.name.titleize %></h1>

<h3>Total Stock</h3>
<div class="row">
  <div class="col-6">

  <table class="table">
    <thead>
      <th>Paper Type</th>
      <th>A4</th>
      <th>A3</th>
    </thead>
    <tbody>
      <% PaperType.all.select(:name).distinct.pluck(:name).each do |paper_type| %>
      <tr>
        <td><%= paper_type.titleize %></td>
        <td><%= @customer.sheets.quantity_by_type(paper_type, 'A4') %></td>
        <td><%= @customer.sheets.quantity_by_type(paper_type, 'A3') %></td>
      </tr>
      <% end %>
    </tbody>
  </table>
  </div>
</div>

<div class="row mt-5 mb-3">
  <div class="col">
    <h3>Paper Collections</h3>
    <%= button_to 'Add Collection', new_customer_paper_collection_path, method: :get, class: 'btn btn-success mt-3' %>
  </div>
</div>

<div class="row">
  <table class="table">
    <thead>
      <th>Date</th>
      <% PaperType.all.order(:size, :name).each do |type| %>
      <th><%= type.label %></th>
      <% end %>
    </thead>
    <tbody>
      <% @customer.paper_collections.each do |collection| %>
      <tr>
        <td><%= collection.date_collected.strftime('%d %B %Y') %></td>
        <% collection.paper_collection_items.by_paper_type.each do |item| %>
        <td><%= item.quantity_collected %></td>
        <% end %>
      </tr>
      <% end %>
    </tbody>
  </table>

</div>
